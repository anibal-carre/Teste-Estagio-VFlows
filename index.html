<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="icon" type="image/x-icon" href="./img/logo.png" />
    <link rel="stylesheet" href="./css/styles.css" />
    <title>Teste Estagio VFlows</title>
  </head>
  <body>
    <!----------------  BODY ---------------->
    <div class="container-app">
      <h1 class="title">CADASTRO FORNECEDOR/PRODUTO</h1>

      <div class="form-container">
        <div class="form-title border bg-primary">
          <span>Dados do Fornecedor</span>
        </div>
        <form class="d-flex flex-column" id="form-app" action="">
          <div class="inputs-container">
            <div class="d-flex flex-column large-input">
              <span>Razão Social</span>
              <input
                id="razao-social"
                class="input-form"
                type="text"
                required
              />
            </div>
            <div class="d-flex flex-column short-input">
              <span>CNPJ</span>
              <input id="cnpj" class="input-form" type="number" required />
            </div>
          </div>
          <div class="inputs-container">
            <div class="d-flex flex-column large-input">
              <span>Nome Fantasia</span>
              <input
                id="nome-fantasia"
                class="input-form"
                type="text"
                required
              />
            </div>
            <div class="d-flex flex-column short-input">
              <span>Inscrição Estadual</span>
              <input
                id="inscriçao-estadual"
                class="input-form"
                type="text"
                required
              />
            </div>
          </div>

          <div class="inputs-container">
            <div class="d-flex flex-column short-input-2">
              <span>CEP</span>
              <input id="cep" class="input-form" type="number" required />
            </div>
            <div class="d-flex flex-column short-input">
              <span>Inscrição Municipal</span>
              <input
                id="inscriçao-municipal"
                class="input-form"
                type="text"
                required
              />
            </div>
          </div>

          <div class="inputs-container">
            <div class="d-flex flex-column large-input">
              <span>Endereço</span>
              <input id="endereço" class="input-form" type="text" required />
            </div>
            <div class="d-flex flex-column short-input">
              <span>Número</span>
              <input id="numero" class="input-form" type="number" required />
            </div>
          </div>

          <div class="inputs-container">
            <div class="d-flex flex-column large-input-2">
              <span>Complemento</span>
              <input id="complemento" class="input-form" type="text" required />
            </div>
          </div>

          <div class="inputs-container">
            <div class="d-flex flex-column short-input-3">
              <span>Bairro</span>
              <input id="bairro" class="input-form" type="text" required />
            </div>
            <div class="d-flex flex-column short-input-3">
              <span>Municipio</span>
              <input id="municipio" class="input-form" type="text" required />
            </div>

            <div class="d-flex flex-column short-input-3">
              <span>Estado</span>
              <input id="estado" class="input-form" type="text" required />
            </div>
          </div>

          <div class="inputs-container">
            <div class="d-flex flex-column large-input-3">
              <span>Nome da Pessoa de Contato</span>
              <input id="nome-pessoa" class="input-form" type="text" required />
            </div>
            <div class="d-flex flex-column short-input-3">
              <span>Telefone</span>
              <input id="telefone" class="input-form" type="number" required />
            </div>

            <div class="d-flex flex-column short-input-3">
              <span>E-mail</span>
              <input id="email" class="input-form" type="text" required />
            </div>
          </div>
        </form>
      </div>

      <!------------  PRODUTOS ------------>
      <div id="products-container" class="form-container">
        <div class="form-title border bg-primary">
          <span>Produtos</span>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", function () {
            const products = [
              `<form class="d-flex flex-column product-form" id="form-app-2" action="">
              <div class="product-card">
                <div class="trash-icon-div" onclick="deleteForm(this)">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="50"
                    height="50"
                    fill="white"
                    class="bi bi-trash-fill"
                    viewBox="0 0 16 16"
                  >
                    <path
                      d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0"
                    />
                  </svg>
                </div>
                <div class="card">
                  <div class="product-icon-div">
                    <div class="product-icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="70"
                        height="70"
                        fill="white"
                        class="bi bi-box-seam"
                        viewBox="0 0 16 16"
                      >
                        <path
                          d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5l2.404.961L10.404 2zm3.564 1.426L5.596 5 8 5.961 14.154 3.5zm3.25 1.7-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464z"
                        />
                      </svg>
                    </div>
                  </div>
                  <div class="product-inputs">
                    <div class="product-div product">
                      <span>Produto</span>
                      <input id="product-name" class="product-input" type="text" />
                    </div>
            
                    <div class="product-divs-inputs">
                      <div class="product-div product">
                        <span>UND.Medida</span>
                        <input id="und-medida" class="product-input" type="number" />
                      </div>
                      <div class="product-div product">
                        <span>QDTDE. em Estoque</span>
                        <input id="qdtde" class="product-input" type="number" />
                      </div>
                      <div class="product-div product">
                        <span>Valor Unitário</span>
                        <input id="valor-unitario" class="product-input" type="number" />
                      </div>
                      <div class="product-div product">
                        <span>Valor Total</span>
                        <input id="valor-total" class="product-input" disabled type="number" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>`,
            ];

            const formsContainer =
              document.getElementById("products-container");
            const addButton = document.getElementById("btn-add-product");

            if (formsContainer && addButton) {
              products.forEach((product, index) => {
                const div = document.createElement("div");
                const form = document.createElement("form");

                form.classList.add("d-flex", "flex-column", "product-form");
                form.id = `form-app-${index + 3}`;
                form.action = "";

                div.innerHTML = product;
                div.firstChild.id = `form-app-${index + 2}`;

                formsContainer.insertBefore(form, addButton);
                form.appendChild(div.firstChild);

                const valorUnitarioInput =
                  form.querySelector("#valor-unitario");
                const cantidadEnStockInput = form.querySelector("#qdtde");
                const valorTotalInput = form.querySelector("#valor-total");

                valorUnitarioInput.addEventListener("change", updateValorTotal);
                cantidadEnStockInput.addEventListener(
                  "change",
                  updateValorTotal
                );

                function updateValorTotal() {
                  const valorUnitario =
                    parseFloat(valorUnitarioInput.value) || 0;
                  const cantidadEnStock =
                    parseFloat(cantidadEnStockInput.value) || 0;

                  const valorTotal = valorUnitario * cantidadEnStock;
                  valorTotalInput.value = valorTotal.toFixed(2);
                }
              });
            } else {
              console.error(
                "El elemento con ID 'products-container' o 'btn-add-product' no se encontró en el documento."
              );
            }
          });

          function deleteForm(element) {
            const formContainer = element.closest(".product-form");
            if (formContainer) {
              formContainer.remove();
            }
          }
        </script>

        <button id="btn-add-product" class="btn-add">Adicionar Produto</button>
      </div>

      <!------------  Anexos ------------>

      <div id="form-container" class="form-container">
        <div class="form-title border bg-primary">
          <span>Anexos</span>
        </div>

        <form class="d-flex flex-column" id="form-app-3" action="">
          <label id="add-anexo" for="file" class="input-file-trigger"
            >Incluir Anexo</label
          >
          <input
            id="file"
            class="input-file"
            type="file"
            onchange="handleFileSelect(this)"
          />
        </form>
      </div>

      <button class="btn-add" id="btn-send">Salvar Fornecedor</button>
    </div>

    <!-- MODAL -->

    <div
      class="modal"
      id="loadingModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="loadingModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <div class="spinner-border" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Enviando dados...</p>
          </div>
        </div>
      </div>
    </div>

    <!-----------------  BODY ----------------->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <script src="./js/script.js"></script>
  </body>
</html>
